gdp_num <- as.numeric(gsub(",",gdp$X.3))
gdp_num <- as.numeric(gsub(",", gdp$X.3))
gdp_num <- as.numeric(gsub(",", "", gdp$X.3))
?as.numeric
?mean
gdp_num
gdp_mean <- mean(gdp_num, na.rm=TRUE)
gdp <- read.csv("../gdp.csv")
edu <- read.csv("../edu.csv")
gdp_num <- as.numeric(gsub(",", "", gdp$X.3))
gdp_mean <- mean(gdp_num, na.rm=TRUE)
gdp
gdp <- gdp[5:219, ]
gdp_num <- as.numeric(gsub(",", "", gdp$X.3))
gdp_mean <- mean(gdp_num, na.rm=TRUE)
gdp
countryNames <- gdp$X.2
countryNames <- as.character(gdp$X.2)
grep("United$",countryNames)
grep("^United",countryNames)
grep("*United",countryNames)
gdp <- read.csv("../gdp.csv")
edu <- read.csv("../edu.csv")
mergedData = merge(gdp,edu,by.x="X",by.y="CountryCode",all=FALSE)
mergedData$Gross.domestic.product.2012 <- as.numeric(as.character(mergedData$Gross.domestic.product.2012))
str(mergedData)
mergedData$Special.Notes <- as.character(mergedData$Special.Notes)
str(mergedData)
?grep
grep("([Ff]iscal)&((June)|(june))", mergedData$Special.Notes)
grep("(June)|(june)", mergedData$Special.Notes)
grep("(Fiscal)|(fiscal)", grep("(June)|(june)", mergedData$Special.Notes))
grep("(June)|(june)", mergedData$Special.Notes)
count(grep("(June)|(june)", mergedData$Special.Notes))
length(grep("(June)|(june)", mergedData$Special.Notes))
length(grep("(Fiscal)&(June)", mergedData$Special.Notes))
length(grep("(Fiscal)", mergedData$Special.Notes))
length(grep("(Fiscal)*(June)", mergedData$Special.Notes))
install.packages("quantmod")
library(quantmod)
?which
amzn = getSymbols("AMZN",auto.assign=FALSE)
sampleTimes = index(amzn)
str(amzn)
head(amzn)
sampleTimes
str(sampleTimes)
year(sampleTimes)
library(lubridate)
year(sampleTaimes)
year(sampleTimes)
length(year(sampleTimes) == 2012)
year(sampleTimes) == 2012)
year(sampleTimes) == 2012
?countif
library(lubridate)
years_2012 <- year(sampleTimes) == 2012
length(sampleTimes[which(years_2012)])
wday(sampleTimes)
wday(sampleTimes, label=TRUE)
years_2012_mon <- year(sampleTimes) == 2012 & wday(sampleTimes) == 2
length(sampleTimes[which(years_2012_mon)])
mergedData = merge(gdp,edu,by.x="X",by.y="CountryCode",all=FALSE)
mergedData$Gross.domestic.product.2012 <- as.numeric(as.character(mergedData$Gross.domestic.product.2012))
mergedData$Special.Notes <- as.character(mergedData$Special.Notes)
length(grep("^Fiscal*June", mergedData$Special.Notes))
length(grep("^Fiscal", mergedData$Special.Notes))
#5
length(grep("^Fiscal.June", mergedData$Special.Notes))
length(grep("Fiscal.June", mergedData$Special.Notes))
length(grep("^Fiscal.*June", mergedData$Special.Notes))
set.seed(1234)
par(mar = c(0,0,0,0))
x <- rnorm(12, mean = rep(1:3, each = 4), sd = 0.2)
y <- rnorm(12, mean = rep(c(1,2,1), each = 4), sd = 0.2)
plot(x, y, col="blue", pch= 19, cex = 2)
text(x + 0.05, y + 0.05, labels = as.character(1:12))
dataFrame <- data.frame(x = x, y = y)
dist(dataFrame)
?hclust
dataFrame <- data.frame(x = x, y = y)
dist(dataFrame) # Euclidean distance
distxy <- dist(dataFrame)
hClustering <- hclust(distxy)
plot(hClustering)
hClustering <- hclust(distxy)
par(mar = c(4,4,4,4))
plot(hClustering)
set.seed(143)
dataMatrix <- as.matrix(dataFrame)[sample(1:12),]
heatmap(dataMatrix)
set.seed(1234)
par(mar = c(0,0,0,0))
x <- rnorm(12, mean = rep(1:3, each = 4), sd = 0.2)
y <- rnorm(12, mean = rep(c(1,2,1), each = 4), sd = 0.2)
plot(x, y, col="blue", pch= 19, cex = 2)
text(x + 0.05, y + 0.05, labels = as.character(1:12))
set.seed(1234)
par(mar = c(0,0,0,0))
x <- rnorm(12, mean = rep(1:3, each = 4), sd = 0.2)
y <- rnorm(12, mean = rep(c(1,2,1), each = 4), sd = 0.2)
plot(x, y, col="blue", pch= 19, cex = 2)
text(x + 0.05, y + 0.05, labels = as.character(1:12))
dataFrame <- data.frame(x = x, y = y)
kmeansObj <- kmeans(dataFrame, centers=3)
names(kmeansObj)
kmeansObj$cluster
par(mar = rep(0.2, 4))
plot(x, y, col = kmeansOcj$cluster, pch= 19, cex = 2)
points(kmeansObject$centers, col= 1:3, pch = 3, lwd=3)
par(mar = rep(0.2, 4))
plot(x, y, col = kmeansObj$cluster, pch= 19, cex = 2)
points(kmeansObject$centers, col= 1:3, pch = 3, lwd=3)
points(kmeansObj$centers, col= 1:3, pch = 3, lwd=3)
set.seed(1234)
dataMatrix <- as.matrix(dataFrame)[sample(1:12),]
kmeansObj2 <- kmeans(dataFrame, centers=3)
par(mfrow = c(1,2), mar=c(2,4,0.1,0.1))
image(t(dataMatrix)[,nrow(dataMatrix):1], yaxt = "n")
image(t(dataMatrix)[,order(kmeansObj$cluster)], yaxt = "n")
set.seed(12345)
par(mar= rep(0.2,4))
dataMatrix <- matrix(rnorm(400), nrow=40)
image(1:10, 1:40, t(dataMatrix)[, nrow(dataMatrix):1])
heatmap(dataMatrix)
set.seed(678910)
for (i in 1:40)
{
# flip a coin
coinFlip <- rbinom(1, size=1, prob=0.5)
# if coin is heads add a common pattern to the row
if (coinFlip)
{
dataMatrix[i, ] <- dataMatrix[i,] + rep(c(0,3), each=5)
}
}
image(1:10, 1:40, t(dataMatrix)[, nrow(dataMatrix):1])
heatmap(dataMatrix)
hh <- hclust(dist(dataMatrix))
dataMatrixOrdered <- dataMatrix[hh$order,]
par(mfrow=c(1,3))
image(t(dataMatrixOrdered)[,nrow(dataMatrixOrdered):1])
plot(rowMeans(dataMatrixOrdered), 40:1,,xlab = "Row Mean", ylab="Row" pch=19)
plot(colMeans(dataMatrixOrdered), xlab = "Column", ylab="Column Mean" pch=19)
plot(rowMeans(dataMatrixOrdered), 40:1,,xlab = "Row Mean", ylab="Row", pch=19)
plot(colMeans(dataMatrixOrdered), xlab = "Column", ylab="Column Mean", pch=19)
par(mfrow=c(1,3), mar=c(4,4,4,4))
image(t(dataMatrixOrdered)[,nrow(dataMatrixOrdered):1])
plot(rowMeans(dataMatrixOrdered), 40:1,,xlab = "Row Mean", ylab="Row", pch=19)
plot(colMeans(dataMatrixOrdered), xlab = "Column", ylab="Column Mean", pch=19)
svd1 <- svd(scale(dataMatrixOrdered))
par(mfrow=c(1,3))
image(t(dataMatrixOrdered)[,nrow(dataMatrixOrdered):1])
plot(svd1$u[,1],40:1,,xlab="Row",ylab="First left Singular Vector", pch=19)
plot(svd1$v[,1],xlab="Column",ylab="First right Singular Vector", pch=19)
par(mfrow=c(1,2))
plot(svc1$d,xlab="Column", ylab="Singular Value", pch=19)
plot(svc1$d^2/sum(svd1$d^2),xlab="Column", ylab="Prop of variance explained, pch=19)
plot(svd1$d,xlab="Column", ylab="Singular Value", pch=19)
plot(svd1$d^2/sum(svd1$d^2),xlab="Column", ylab="Prop of variance explained, pch=19)
heatmap(dataMatrix)
par(mfrow=c(1,2))
plot(svd1$d, xlab="Column", ylab="Singular Value", pch=19)
plot(svd1$d^2/sum(svd1$d^2),xlab="Column", ylab="Prop of variance explained", pch=19)
par(mfrow=c(1,2))
plot(svd1$d, xlab="Column", ylab="Singular Value", pch=19)
plot(svd1$d^2/sum(svd1$d^2),xlab="Column", ylab="Prop of variance explained", pch=19)
pca1 <- prcomp(dataMatrixOrdered, scale=TRUE)
plot(pca1$rotation[,1], svd1$v[,1] pch=19, xlab="Principal Component", ylab="Right singular vector1")
abline(c(0,1))
pca1 <- prcomp(dataMatrixOrdered, scale=TRUE)
plot(pca1$rotation[,1], svd1$v[,1], xlab="Principal Component", ylab="Right singular vector1", pch=19)
abline(c(0,1))
constantMatrix <- dataMatrixOrdered*0
for(i in 1:dim(dataMatrixOrdered)[1]){constantMatrix[i,] <- rep(c(0,1) each=5)}
svd1 <- svd(constantMatrix)
par(mfrow=c(1,3))
image(t(constantMatrix)[,nrow(constantMatrix):1])
plot(svd1$u[,1],40:1,,xlab="Row",ylab="First left Singular Vector", pch=19)
plot(svd1$v[,1],xlab="Column",ylab="First right Singular Vector", pch=19)
constantMatrix <- dataMatrixOrdered*0
for(i in 1:dim(dataMatrixOrdered)[1])
{constantMatrix[i,] <- rep(c(0,1), each=5)}
svd1 <- svd(constantMatrix)
par(mfrow=c(1,3))
image(t(constantMatrix)[,nrow(constantMatrix):1])
plot(svd1$u[,1],40:1,,xlab="Row",ylab="First left Singular Vector", pch=19)
plot(svd1$v[,1],xlab="Column",ylab="First right Singular Vector", pch=19)
install.packages(kernlab)
install.packages("kernlab")
clear()
cls()
cl()
?clear
??clear
rm()
rm(*)
?rm
rm(ls())
rm(list=ls())
library(kernlab)
data(spam)
library(kernlab)
data(spam)
set.seed(3435)
trainIndicator = rbinom(4601, size = 1, prob=0.5)
table(trainIndication)
trainIndicator = rbinom(4601, size = 1, prob=0.5)
table(trainIndicator)
set.seed(3435)
trainIndicator = rbinom(4601, size = 1, prob=0.5)
table(trainIndicator)
trainSpam = spam[trainIndicator == 1,]
testSpam = spam[trainIndicator == 0,]
names(trainSpam)
head(trainSpam)
table(trainSpam$type)
plot(log10(trainSpam$capitalAve + 1) ~ trainSpam$type)
plot(log10(trainSpam$capitalAve + 1) ~ trainSpam$type)
hClusterUpdated = hclust(dist(t(log10(trainSpam[,1:55] +1))))
plot(hClusterUpdated)
library(boot)
trainSpam$numType = as.numeric(trainSpan$type) - 1
costFunction = function(x,y) sum(x != (y > 0.5))
cvError = rep(NA, 55)
library(boot)
for (i in 1:55)
{
lmFormula = reformulate(names(trainSpam)[i], response = "numType")
glmFit = glm(lmFormula, family="binomial", data=trainSpam)
cvError[i] = cv.glm(trainSpam, glmFit, costFunction, 2)$delta[2]
}
library(kernlab)
trainSpam$numType = as.numeric(trainSpam$type) - 1
costFunction = function(x,y) sum(x != (y > 0.5))
cvError = rep(NA, 55)
library(boot)
for (i in 1:55)
{
lmFormula = reformulate(names(trainSpam)[i], response = "numType")
glmFit = glm(lmFormula, family="binomial", data=trainSpam)
cvError[i] = cv.glm(trainSpam, glmFit, costFunction, 2)$delta[2]
}
names(trainSpam)[which.min(cvError)]
predictionModel = glm(numType ~ charDollar), family="binomial", data=trainSpam)
predictionTest = predict(predictionModel, testSpam)
predictedSpam = rep("nonspam", dim(testSpam)[1])
predictedSpam[predictionModel$fitted > 0.5] = "spam"
predictionModel = glm(numType ~ charDollar, family="binomial", data=trainSpam)
predictionTest = predict(predictionModel, testSpam)
predictedSpam = rep("nonspam", dim(testSpam)[1])
predictedSpam[predictionModel$fitted > 0.5] = "spam"
table(predictedSpam, testSpam$type)
library(ggplot2)
?qplot
?weekdays
---
title: "Reproducible Research: Peer Assessment 1"
output:
html_document:
keep_md: true
---
## Loading and preprocessing the data
#1
activity_df <- read.csv("activity.csv")
#2
library(data.table)
activity <- as.data.table(activity_df)
activity_by_date <- activity[,sum(steps,na.rm=TRUE), by=date]
setnames(activity_by_date, "V1", "total_steps")
activity_by_interval <- activity[,mean(steps,na.rm=TRUE), by=interval]
setnames(activity_by_interval, "V1", "average_steps")
## What is mean total number of steps taken per day?
#1
hist(activity_by_date$total_steps, xlab="Total Steps", main="Histogram of Total Steps per day")
#2
mean_steps <- mean(activity_by_date$total_steps, na.rm=TRUE)
median_steps <- median(activity_by_date$total_steps, na.rm=TRUE)
## What is the average daily activity pattern?
#1
plot(type="l", activity_by_interval$interval, activity_by_interval$average_steps)
#2
max_average_steps <- max(activity_by_interval$average_steps)
max_average_steps_interval <- subset(activity_by_interval, average_steps == max_average_steps)$interval
## Imputing missing values
#1
activity_clean <- merge(activity, activity_by_interval, by="interval")
nas <- which(is.na(activity_clean$steps))
total_nas <- length(nas)
#2
activity_clean$steps[is.na(activity_clean$steps)] <- activity_clean$average_steps[is.na(activity_clean$steps)]
#3
activity_clean <- activity_clean[,average_steps:=NULL]
#4
activity_clean_by_date <- activity_clean[,sum(steps,na.rm=TRUE), by=date]
setnames(activity_clean_by_date, "V1", "total_steps")
hist(activity_clean_by_date$total_steps, xlab="Total Steps", main="Histogram of Total Steps per day")
mean_clean_steps <- mean(activity_clean_by_date$total_steps)
median_clean_steps <- median(activity_clean_by_date$total_steps)
## Are there differences in activity patterns between weekdays and weekends?
library(ggplot2)
activity_clean_by_date$weekday <- weekdays(activity_clean_by_date$date)
activity_df <- read.csv("activity.csv")
#2
library(data.table)
activity <- as.data.table(activity_df)
activity_by_date <- activity[,sum(steps,na.rm=TRUE), by=date]
setnames(activity_by_date, "V1", "total_steps")
activity_by_interval <- activity[,mean(steps,na.rm=TRUE), by=interval]
setnames(activity_by_interval, "V1", "average_steps")
## What is mean total number of steps taken per day?
#1
hist(activity_by_date$total_steps, xlab="Total Steps", main="Histogram of Total Steps per day")
#2
mean_steps <- mean(activity_by_date$total_steps, na.rm=TRUE)
median_steps <- median(activity_by_date$total_steps, na.rm=TRUE)
## What is the average daily activity pattern?
#1
plot(type="l", activity_by_interval$interval, activity_by_interval$average_steps)
#2
max_average_steps <- max(activity_by_interval$average_steps)
max_average_steps_interval <- subset(activity_by_interval, average_steps == max_average_steps)$interval
## Imputing missing values
#1
activity_clean <- merge(activity, activity_by_interval, by="interval")
nas <- which(is.na(activity_clean$steps))
total_nas <- length(nas)
#2
activity_clean$steps[is.na(activity_clean$steps)] <- activity_clean$average_steps[is.na(activity_clean$steps)]
#3
activity_clean <- activity_clean[,average_steps:=NULL]
#4
activity_clean_by_date <- activity_clean[,sum(steps,na.rm=TRUE), by=date]
setnames(activity_clean_by_date, "V1", "total_steps")
hist(activity_clean_by_date$total_steps, xlab="Total Steps", main="Histogram of Total Steps per day")
mean_clean_steps <- mean(activity_clean_by_date$total_steps)
median_clean_steps <- median(activity_clean_by_date$total_steps)
setwd("E:\\coursera\\reproducible\\")
setwd("E:\\Coursera\\Reproducible\\RepData_PeerAssessment1")
---
title: "Reproducible Research: Peer Assessment 1"
output:
html_document:
keep_md: true
---
## Loading and preprocessing the data
#1
activity_df <- read.csv("activity.csv")
#2
library(data.table)
activity <- as.data.table(activity_df)
activity_by_date <- activity[,sum(steps,na.rm=TRUE), by=date]
setnames(activity_by_date, "V1", "total_steps")
activity_by_interval <- activity[,mean(steps,na.rm=TRUE), by=interval]
setnames(activity_by_interval, "V1", "average_steps")
## What is mean total number of steps taken per day?
#1
hist(activity_by_date$total_steps, xlab="Total Steps", main="Histogram of Total Steps per day")
#2
mean_steps <- mean(activity_by_date$total_steps, na.rm=TRUE)
median_steps <- median(activity_by_date$total_steps, na.rm=TRUE)
## What is the average daily activity pattern?
#1
plot(type="l", activity_by_interval$interval, activity_by_interval$average_steps)
#2
max_average_steps <- max(activity_by_interval$average_steps)
max_average_steps_interval <- subset(activity_by_interval, average_steps == max_average_steps)$interval
## Imputing missing values
#1
activity_clean <- merge(activity, activity_by_interval, by="interval")
nas <- which(is.na(activity_clean$steps))
total_nas <- length(nas)
#2
activity_clean$steps[is.na(activity_clean$steps)] <- activity_clean$average_steps[is.na(activity_clean$steps)]
#3
activity_clean <- activity_clean[,average_steps:=NULL]
#4
activity_clean_by_date <- activity_clean[,sum(steps,na.rm=TRUE), by=date]
setnames(activity_clean_by_date, "V1", "total_steps")
hist(activity_clean_by_date$total_steps, xlab="Total Steps", main="Histogram of Total Steps per day")
mean_clean_steps <- mean(activity_clean_by_date$total_steps)
median_clean_steps <- median(activity_clean_by_date$total_steps)
## Are there differences in activity patterns between weekdays and weekends?
library(ggplot2)
activity_clean_by_date$weekday <- weekdays(activity_clean_by_date$date)
activity_df <- read.csv("activity.csv")
library(data.table)
activity <- as.data.table(activity_df)
activity_by_date <- activity[,sum(steps,na.rm=TRUE), by=date]
setnames(activity_by_date, "V1", "total_steps")
activity_by_interval <- activity[,mean(steps,na.rm=TRUE), by=interval]
setnames(activity_by_interval, "V1", "average_steps")
## What is mean total number of steps taken per day?
#1
hist(activity_by_date$total_steps, xlab="Total Steps", main="Histogram of Total Steps per day")
#2
mean_steps <- mean(activity_by_date$total_steps, na.rm=TRUE)
median_steps <- median(activity_by_date$total_steps, na.rm=TRUE)
## What is the average daily activity pattern?
#1
plot(type="l", activity_by_interval$interval, activity_by_interval$average_steps)
#2
max_average_steps <- max(activity_by_interval$average_steps)
max_average_steps_interval <- subset(activity_by_interval, average_steps == max_average_steps)$interval
## Imputing missing values
#1
activity_clean <- merge(activity, activity_by_interval, by="interval")
nas <- which(is.na(activity_clean$steps))
total_nas <- length(nas)
#2
activity_clean$steps[is.na(activity_clean$steps)] <- activity_clean$average_steps[is.na(activity_clean$steps)]
#3
activity_clean <- activity_clean[,average_steps:=NULL]
activity_clean_by_date <- activity_clean[,sum(steps,na.rm=TRUE), by=date]
setnames(activity_clean_by_date, "V1", "total_steps")
hist(activity_clean_by_date$total_steps, xlab="Total Steps", main="Histogram of Total Steps per day")
mean_clean_steps <- mean(activity_clean_by_date$total_steps)
median_clean_steps <- median(activity_clean_by_date$total_steps)
library(ggplot2)
activity_clean$weekday <- weekdays(activity_clean$date)
activity$date <- as.Date(activity$date)
activity_by_date <- activity[,sum(steps,na.rm=TRUE), by=date]
setnames(activity_by_date, "V1", "total_steps")
activity_by_interval <- activity[,mean(steps,na.rm=TRUE), by=interval]
setnames(activity_by_interval, "V1", "average_steps")
## What is mean total number of steps taken per day?
#1
hist(activity_by_date$total_steps, xlab="Total Steps", main="Histogram of Total Steps per day")
#2
mean_steps <- mean(activity_by_date$total_steps, na.rm=TRUE)
median_steps <- median(activity_by_date$total_steps, na.rm=TRUE)
## What is the average daily activity pattern?
#1
plot(type="l", activity_by_interval$interval, activity_by_interval$average_steps)
#2
max_average_steps <- max(activity_by_interval$average_steps)
max_average_steps_interval <- subset(activity_by_interval, average_steps == max_average_steps)$interval
## Imputing missing values
#1
activity_clean <- merge(activity, activity_by_interval, by="interval")
nas <- which(is.na(activity_clean$steps))
total_nas <- length(nas)
#2
activity_clean$steps[is.na(activity_clean$steps)] <- activity_clean$average_steps[is.na(activity_clean$steps)]
#3
activity_clean <- activity_clean[,average_steps:=NULL]
#4
activity_clean_by_date <- activity_clean[,sum(steps,na.rm=TRUE), by=date]
setnames(activity_clean_by_date, "V1", "total_steps")
hist(activity_clean_by_date$total_steps, xlab="Total Steps", main="Histogram of Total Steps per day")
mean_clean_steps <- mean(activity_clean_by_date$total_steps)
median_clean_steps <- median(activity_clean_by_date$total_steps)
library(ggplot2)
activity_clean$weekday <- weekdays(activity_clean$date)
activity_clean
?weekdays
str(activity_clean)
?grep
gsub("Monday|Tuesday|Wednesday|Thursday|Friday", "Weekday", activity_clean$weekday)
activity_clean$weekday <- gsub("Monday|Tuesday|Wednesday|Thursday|Friday", "Weekday", activity_clean$weekday)
activity_clean$weekday <- gsub("Saturday|Sunday", "Weekend", activity_clean$weekday)
activity_clean
?qplot
activity_clean_by_date$weekday <- weekdays(activity_clean_by_date$date)
activity_clean_by_date$weekday <- gsub("Monday|Tuesday|Wednesday|Thursday|Friday", "Weekday", activity_clean_by_date$weekday)
activity_clean_by_date$weekday <- gsub("Saturday|Sunday", "Weekend", activity_clean_by_date$weekday)
qplot(intevals, steps, activity_clean_by_date, facets = .~weekday)
qplot(intevals, steps, activity_clean_by_date, facets = weekday)
qplot(intevals, steps, activity_clean_by_date, facets = activity_clean_by_date$weekday)
activity_clean_by_date$weekday <- as.Factor(activity_clean_by_date$weekday)
activity_clean_by_date$weekday <- as.factor(activity_clean_by_date$weekday)
qplot(intevals, steps, activity_clean_by_date, facets = activity_clean_by_date$weekday)
qplot(intevals, steps, activity_clean_by_date, facets = weekday)
qplot(intevals, steps, activity_clean_by_date, facets = . ~ weekday)
qplot(intevals, steps, activity_clean_by_date)
qplot(intervals, steps, activity_clean_by_date)
qplot(interval, steps, activity_clean_by_date)
activity_clean_by_date
head(activity_clean_by_date$weekday)
head(activity_clean_by_date)
qplot(interval, steps, activity_clean)
head(activity_clean)
activity_clean_by_interval <- activity_mean[,mean(steps,na.rm=TRUE), by=interval]
activity_clean_by_interval <- activity_clean[,mean(steps,na.rm=TRUE), by=interval]
activity_clean_by_interval
?aggregate
activity_clean <- as.data.frame(activity_clean)
activity_clean
str(activity_clean)
activity_clean$weekday <- as.factor(activity_clean$weekday)
str(activity_clean)
source('~/.active-rstudio-document', echo=TRUE)
activity_clean <- as.data.frame(activity_clean)
activity_clean$weekday <- weekdays(activity_clean$date)
activity_clean$weekday <- gsub("Monday|Tuesday|Wednesday|Thursday|Friday", "Weekday", activity_clean$weekday)
activity_clean$weekday <- gsub("Saturday|Sunday", "Weekend", activity_clean$weekday)
activity_clean$weekday <- as.factor(activity_clean$weekday)
aggregate(activity_clean$steps, by=list(weekday, interval), FUN = mean)
aggregate(activity_clean$steps, by=list(activity_clean$weekday, activity_clean$interval), FUN = mean)
aggregate(activity_clean$steps, by=list(Weekday = activity_clean$weekday, Interval = activity_clean$interval), FUN = mean)
activity_clean_grouped <- aggregate(activity_clean$steps, by=list(Weekday = activity_clean$weekday, Interval = activity_clean$interval), FUN = mean)
str(activity_clean_grouped)
qplot(Interval, x, activity_clean_by_interval, facets = .~Weekday)
qplot(Interval, x, activity_clean_by_interval, facets = .~activity_clean_by_interval$Weekday)
qplot(Interval, x, activity_clean_by_interval)
qplot(activity_clean_by_interval$Interval, x, activity_clean_by_interval)
qplot(activity_clean_by_interval$Interval, activity_clean_by_interval$x, activity_clean_by_interval)
library(lattice)
plot <- ggplot(data = activity_clean_by_interval, aes(x = Interval, y = x, group=1))
plot + geom_line()
plot <- ggplot(data = activity_clean_by_interval, aes(Interval, x, group=1))
plot + geom_line()
